@model UploadFileModel
@{
    SetTitle("Ladda upp en fil");
}
<div class="std-panel std-form lb-panel-small lb-validate-form">
    @using (Html.BeginForm("Upload", "Upload", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        <div>
            <h3 class="section-title">Ladda upp en fil</h3>
            <div class="file-upload-box">
                <div class="file-input">
                    @Html.File(x => x.UploadedFile)
                </div>
                <p class="file-message">Maximal filstorlek: @Model.MaxFileSize MB</p>
            </div>
        </div>
        <div class="text">
            @Html.LabelFor(x => x.Title)
            @Html.TextBoxFor(x => x.Title)
        </div>
        <div class="text">
            @Html.LabelFor(x => x.Description)
            @Html.TextBoxFor(x => x.Description)
        </div>
        <div class="submit" style="padding-top:8px">
            @Html.AntiForgeryToken()
            @Html.Submit("Spara")
            @Html.Cancel("Avbryt")
        </div>
    }
</div>
<script>
    $(document).ready(function () {
        $('#UploadedFile').bind('change', function () {
            if (this.files.length === 0) {
                fileBoxStyle(false, '#aaa', '#fff', 'Maximal filstorlek: @Model.MaxFileSize MB.');
                return;
            }
            var fileSize = this.files[0].size / (1024 * 1024);
            if (fileSize > @Model.MaxFileSize) {
                $('input[type=submit]').prop('disabled', true);
                fileBoxStyle(true, '#e44444', '#fff5f5', 'Filen överskrider den maximala filstorleken på @Model.MaxFileSize MB.');
            }
            else {

                fileBoxStyle(false, '#2ecc71', '#f6fffa', 'Ok!');
            }
        });
        function fileBoxStyle(disableSubmit, borderColor, backgroundColor, text) {
            $('#UploadedFile input[type=submit]').prop('disabled', disableSubmit);
            $('.file-upload-box').css({
                'border-color': borderColor,
                'background-color': backgroundColor
            });
            $('.file-message').css({ 'border-color': borderColor }).html(text);
        }
    });
</script>