@using Appva.Mcss.Admin.Areas.Backoffice.Models
@model Appva.Mcss.Admin.Areas.Backoffice.Models.ListGeneralSettingsModel
@{
    SetTitle("Admin - Generella inställningar");
}
@Html.Partial("_BackofficeMenuPartial")
<div id="subheader" class="cf">
    <h1>Generella inställningar</h1>
</div>
<div id="content" class="cf">
    <script>
        function colorPicker(id1, id2) {
            document.getElementById(id1).value = document.getElementById(id2).value;
        }
        function setCheckboxState(id1, id2) {
            var checkbox = document.getElementById(id2);
            if (document.getElementById(id1).checked) {
                checkbox.value = true;
            } else {
                checkbox.value = false;
            }
        }
        function setButtonState(id) {
            $(id).prop('disabled', false);
        }
        function update(formId, buttonId, index, color, disable, message) {
            $(formId).submit(function (e) {
                $("#submitValue" + index).val($('#' + buttonId).val());
                var formData = $(this).serialize();
                e.preventDefault();
                $.ajax({
                    url: "list/update",
                    type: "POST",
                    data: formData,
                    success: function (result) {
                        if (disable) {
                            $('#' + buttonId).prop('disabled', true);
                        } else {
                            $('#sec-newSigningKey').val(result);
                        }
                        $('#setlist-overlay .success-message').css('background-color', color);
                        $('#setlist-overlay .success-message').text(message);
                        $('#item' + index + ' #setlist-overlay').css('visibility', 'visible').hide();
                        $('#item' + index + ' #setlist-overlay').fadeIn('fast').delay(1500).fadeOut('fast');
                    }
                });
                $(this).unbind();
            });
        }
    </script>
    <div id="content-primary">
        @if (Model.List != null && Model.List.Count() > 0)
        {
            foreach(var item in Model.List)
            {
                @(item.Index == 0 || item.Index > 0 && Model.List.ElementAt(item.Index - 1).Category != item.Category ? Html.Raw("<div id=\"setlist-content\">\r\n<h1>" + item.Category + "</h1><ul id=\"setlist\">\r\n") : Html.Raw(""))
                @Html.Partial("~/Areas/Backoffice/Features/GeneralSettings/Partials/_SettingsList.cshtml", Model, new ViewDataDictionary { { "item", item } })
                @(item.Index < Model.List.Count() - 1 && Model.List.ElementAt(item.Index + 1).Category != item.Category ? Html.Raw("</ul>\r\n</div>\r\n") : Html.Raw(""))
            }
        }
        else
        {
            <div class="note">
                <h2>Inga inställningar hittades.</h2>
            </div>
        }
    </div>
</div>
